<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Light Svitcher</title>
  <style>
      * {
            box-sizing: border-box;
        }

      html {
          min-height: 100vh;
      }

      body {
        min-height: 100%;
        background: linear-gradient(
          19deg,
          #292c30,
          #005066,
          #00787d,
          #009e65,
          #3abe00
        );
      }

      .container {
        display: flex;
        flex-direction: column;
        flex-wrap: wrap;
        justify-content: center;
        align-items: center;
      }

      .container .service {
        background: #F5F5F5 no-repeat 10px 15px;
        border: 1px solid #C0C0C0;
        color: #404040;
        padding: 10px 100px 10px 100px;
        margin: 50px 0;
        -moz-border-radius: 10px;
        -webkit-border-radius: 10px;
        border-radius: 10px;
        -moz-box-shadow: 3px 3px 6px 0 #A9A9A9;
        -webkit-box-shadow: 3px 3px 6px #A9A9A9;
        box-shadow: 3px 3px 6px 0 #A9A9A9;
      }

      .container .service .center {
        max-width: 50%;
      }

      .container .service .title {
        width: 100%;
        text-align: center;
        font-size: 1.2em;
        color: #fff;
      }

      .container .service .title.degraded {
        background-color: #6f42c1;
      }

      .container .service .title.healthy {
        background-color: #28a745;
      }

      .button {
          position: absolute;
          top:50%
      }

      .rounded-button {
          border-radius: 10px;
          border: none;
          padding: 15px 30px;
          cursor: pointer;
          font-size: 16px;
          font-weight: bold;
          transition: background-color 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }

        .green {
          background-color: #4CAF50;
          color: white;
        }

        .red {
          background-color: #f44336;
          color: white;
        }

        .rounded-button:hover {
          background-color: darken(#4CAF50, 10%); /* For green button */
          background-color: darken(#f44336, 10%); /* For red button */
          box-shadow: 0px 5px 10px rgba(0, 0, 0, 0.3);
        }

        
    </style>
</head>
<body>
  <div class="service center">
  <div class="title degraded">
    Light Svitcher
  </div>

  <div class="container">
      <!-- // status -->
      <div class="service">
          <p id="status">–°—Ç–∞—Ç—É—Å: <span id="scriptStatus">–ù–µ –∑–∞–ø—É—â–µ–Ω–æ üî¥</span></p>
          <p>E–ª–µ–∫—Ç—Ä–æ–ø–æ—Å—Ç–∞—á–∞–Ω–Ω—è: <span id="power">–£–≤—ñ–º–∫–Ω–µ–Ω–æüîã</span></p>
          <p>–ü–æ–≤—ñ—Ç—Ä—è–Ω–∞ —Ç—Ä–∏–≤–æ–≥–∞: <span id="alarm">B—ñ–¥—Å—É—Ç–Ω—èüå§Ô∏è</span></p>
          <p>–õ–∞–º–ø–∞: <span id="lamp">B–∏–º–∫–Ω–µ–Ω–æ</span></p>
          <p><span id="day">–î–µ–Ω—åüåû</span></p>
      </div>

      <div class="buttons">
          <!-- chenge status -->
          <button class="rounded-button green" id="startButton" style="display: block;">–ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–∫—Ä–∏–ø—Ç</button>
          <button class="rounded-button red" id="stopButton" style="display: none;">–ó—É–ø–∏–Ω–∏—Ç–∏ —Å–∫—Ä–∏–ø—Ç</button>
      </div>
  </div>
</div>
  <script>
    // get status
    async function updateStatus() {
        const response = await fetch('/status');
        console.log('STATUS RESPONSE:', response);

        const result = await response.json(); 
        console.log('STATUS RESULT:', result);
        console.log('POWER:', result.body.power);
        console.log('ALARM:', result.body.alarm);

        document.getElementById('scriptStatus').textContent = result.status ? '–ó–∞–ø—É—â–µ–Ω–æ üü¢' : '–ù–µ –∑–∞–ø—É—â–µ–Ω–æ üî¥';
        document.getElementById('stopButton').style.display = result.status ? 'block' : 'none';
        document.getElementById('startButton').style.display = result.status ? 'none' : 'block';
        document.getElementById('power').textContent = result.body.power ? '–£–≤—ñ–º–∫–Ω–µ–Ω–æüîã' : 'B–∏–º–∫–Ω–µ–Ω–æü™´';
        document.getElementById('alarm').textContent = result.body.alarm ? '–£–≤—ñ–º–∫–Ω–µ–Ω–æüöÄ' : 'B—ñ–¥—Å—É—Ç–Ω—èüå§Ô∏è';
        document.getElementById('lamp').textContent = result.body.lamp ? '–£–≤—ñ–º–∫–Ω–µ–Ω–æüí°' : 'B–∏–º–∫–Ω–µ–Ω–æ';
        document.getElementById('day').textContent = result.body.sunset ? 'H—ñ—áüåå' : '–î–µ–Ω—åüåû';
        };

    // start script
    document.getElementById('startButton').addEventListener('click', async () => {
        const response = await fetch('/start', { method: 'POST' });
        console.log('STATUS START RESPONSE:', response)

        const result = await response.json();
        console.log('STATUS START RESULT:', result);

        alert(result.message);
        updateStatus();
    });

        document.getElementById('stopButton').addEventListener('click', async () => {
            const response = await fetch('/stop', { method: 'POST' });
            const result = await response.json();
            alert(result.message);
            updateStatus();
        });

    setInterval(updateStatus, 5000);
    updateStatus();
  </script>
</body>
</html>
